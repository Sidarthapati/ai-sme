{
  "id": "kafka_clients_src_main_java_org_apache_kafka_clients_producer_internals_TransactionManager.java_1951",
  "title": "kafka/clients/src/main/java/org/apache/kafka/clients/producer/internals/TransactionManager.java",
  "content": "                    break;\n                } else if (error == Errors.TRANSACTIONAL_ID_AUTHORIZATION_FAILED\n                        || error == Errors.UNSUPPORTED_FOR_MESSAGE_FORMAT) {\n                    fatalError(error.exception());\n                    break;\n                } else {\n                    fatalError(new KafkaException(\"Unexpected error in TxnOffsetCommitResponse: \" + error.message()));\n                    break;\n                }\n            }\n\n            if (result.isCompleted()) {\n                pendingTxnOffsetCommits.clear();\n            } else if (pendingTxnOffsetCommits.isEmpty()) {\n                result.done();\n            } else {\n                // Retry the commits which failed with a retriable error\n                reenqueue();\n            }\n        }\n    }\n\n    private static final class PendingStateTransition {\n        private final TransactionalRequestResult result;\n        private final State state;\n        private final String operation;\n\n        private PendingStateTransition(\n            TransactionalRequestResult result,\n            State state,\n            String operation\n        ) {\n            this.result = result;\n            this.state = state;\n            this.operation = operation;\n        }\n    }\n\n    /**\n     * Returns a ProducerIdAndEpoch object containing the producer ID and epoch\n     * of the ongoing transaction.\n     * This is used when preparing a transaction for a two-phase commit.\n     *\n     * @return a ProducerIdAndEpoch with the current producer ID and epoch.\n     */\n    public ProducerIdAndEpoch preparedTransactionState() {\n        return this.preparedTxnState;\n    }\n}\n",
  "url": "https://github.com/apache/kafka/blob/trunk/clients/src/main/java/org/apache/kafka/clients/producer/internals/TransactionManager.java#L1951-L2000",
  "file_path": "clients/src/main/java/org/apache/kafka/clients/producer/internals/TransactionManager.java",
  "repo_name": "kafka",
  "language": "java",
  "start_line": 1951,
  "end_line": 2000,
  "last_modified": "2026-02-06T01:16:27.610496",
  "source_type": "github"
}