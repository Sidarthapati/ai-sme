{
  "id": "kafka_clients_src_main_java_org_apache_kafka_clients_admin_KafkaAdminClient.java_261",
  "title": "kafka/clients/src/main/java/org/apache/kafka/clients/admin/KafkaAdminClient.java",
  "content": "import org.apache.kafka.common.utils.ExponentialBackoff;\nimport org.apache.kafka.common.utils.KafkaThread;\nimport org.apache.kafka.common.utils.LogContext;\nimport org.apache.kafka.common.utils.ProducerIdAndEpoch;\nimport org.apache.kafka.common.utils.Time;\nimport org.apache.kafka.common.utils.Utils;\n\nimport org.slf4j.Logger;\n\nimport java.security.InvalidKeyException;\nimport java.security.NoSuchAlgorithmException;\nimport java.time.Duration;\nimport java.util.ArrayList;\nimport java.util.Arrays;\nimport java.util.Collection;\nimport java.util.Collections;\nimport java.util.Comparator;\nimport java.util.HashMap;\nimport java.util.HashSet;\nimport java.util.Iterator;\nimport java.util.LinkedHashMap;\nimport java.util.LinkedList;\nimport java.util.List;\nimport java.util.Map;\nimport java.util.Objects;\nimport java.util.Optional;\nimport java.util.OptionalLong;\nimport java.util.Set;\nimport java.util.TreeMap;\nimport java.util.concurrent.TimeUnit;\nimport java.util.concurrent.atomic.AtomicInteger;\nimport java.util.concurrent.atomic.AtomicLong;\nimport java.util.function.Function;\nimport java.util.function.Predicate;\nimport java.util.stream.Collectors;\nimport java.util.stream.Stream;\n\nimport static org.apache.kafka.clients.admin.internals.AdminUtils.validAclOperations;\nimport static org.apache.kafka.common.internals.Topic.CLUSTER_METADATA_TOPIC_NAME;\nimport static org.apache.kafka.common.internals.Topic.CLUSTER_METADATA_TOPIC_PARTITION;\nimport static org.apache.kafka.common.message.AlterPartitionReassignmentsRequestData.ReassignablePartition;\nimport static org.apache.kafka.common.message.AlterPartitionReassignmentsResponseData.ReassignablePartitionResponse;\nimport static org.apache.kafka.common.message.AlterPartitionReassignmentsResponseData.ReassignableTopicResponse;\nimport static org.apache.kafka.common.message.ListPartitionReassignmentsRequestData.ListPartitionReassignmentsTopics;\nimport static org.apache.kafka.common.message.ListPartitionReassignmentsResponseData.OngoingPartitionReassignment;\nimport static org.apache.kafka.common.message.ListPartitionReassignmentsResponseData.OngoingTopicReassignment;\nimport static org.apache.kafka.common.requests.MetadataRequest.convertToMetadataRequestTopic;\nimport static org.apache.kafka.common.requests.MetadataRequest.convertTopicIdsToMetadataRequestTopic;\nimport static org.apache.kafka.common.utils.Utils.closeQuietly;\n\n/**\n * The default implementation of {@link Admin}. An instance of this class is created by invoking one of the\n * {@code create()} methods in {@code AdminClient}. Users should not refer to this class directly.\n *\n * <p>\n * This class is thread-safe.\n * </p>\n */\npublic class KafkaAdminClient extends AdminClient {\n\n    /**\n     * The next integer to use to name a KafkaAdminClient which the user hasn't specified an explicit name for.\n     */\n    private static final AtomicInteger ADMIN_CLIENT_ID_SEQUENCE = new AtomicInteger(1);\n\n    /**\n     * The prefix to use for the JMX metrics for this class\n     */\n    private static final String JMX_PREFIX = \"kafka.admin.client\";\n\n    /**\n     * An invalid shutdown time which indicates that a shutdown has not yet been performed.\n     */\n    private static final long INVALID_SHUTDOWN_TIME = -1;\n\n    /**\n     * The default reason for a LeaveGroupRequest.\n     */\n    static final String DEFAULT_LEAVE_GROUP_REASON = \"member was removed by an admin\";\n\n    /**\n     * Thread name prefix for admin client network thread\n     */\n    static final String NETWORK_THREAD_PREFIX = \"kafka-admin-client-thread\";\n\n    private final Logger log;\n    private final LogContext logContext;\n\n    /**\n     * The default timeout to use for an operation.\n     */\n    private final int defaultApiTimeoutMs;\n\n    /**\n     * The timeout to use for a single request.\n     */\n    private final int requestTimeoutMs;\n\n    /**\n     * The name of this AdminClient instance.\n     */\n    private final String clientId;\n\n    /**\n     * Provides the time.\n     */\n    private final Time time;\n\n    /**\n     * The cluster metadata manager used by the KafkaClient.\n     */\n    private final AdminMetadataManager metadataManager;\n\n    /**\n     * The metrics for this KafkaAdminClient.\n     */\n    final Metrics metrics;\n\n    /**\n     * The network client to use.\n     */\n    private final KafkaClient client;\n\n    /**\n     * The runnable used in the service thread for this admin client.\n     */\n    private final AdminClientRunnable runnable;\n\n    /**\n     * The network service thread for this admin client.\n     */\n    private final Thread thread;\n\n    /**\n     * During a close operation, this is the time at which we will time out all pending operations\n     * and force the RPC thread to exit. If the admin client is not closing, this will be 0.\n     */\n    private final AtomicLong hardShutdownTimeMs = new AtomicLong(INVALID_SHUTDOWN_TIME);\n\n    /**\n     * A factory which creates TimeoutProcessors for the RPC thread.\n     */\n    private final TimeoutProcessorFactory timeoutProcessorFactory;\n\n    private final int maxRetries;\n\n    private final long retryBackoffMs;\n    private final long retryBackoffMaxMs;\n    private final ExponentialBackoff retryBackoff;\n    private final MetadataRecoveryStrategy metadataRecoveryStrategy;",
  "url": "https://github.com/apache/kafka/blob/trunk/clients/src/main/java/org/apache/kafka/clients/admin/KafkaAdminClient.java#L261-L410",
  "file_path": "clients/src/main/java/org/apache/kafka/clients/admin/KafkaAdminClient.java",
  "repo_name": "kafka",
  "language": "java",
  "start_line": 261,
  "end_line": 410,
  "last_modified": "2026-02-06T01:16:27.585045",
  "source_type": "github"
}