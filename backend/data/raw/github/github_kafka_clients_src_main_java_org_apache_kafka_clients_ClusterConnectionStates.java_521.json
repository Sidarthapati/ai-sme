{
  "id": "kafka_clients_src_main_java_org_apache_kafka_clients_ClusterConnectionStates.java_521",
  "title": "kafka/clients/src/main/java/org/apache/kafka/clients/ClusterConnectionStates.java",
  "content": "        /**\n         * Jumps to the next available resolved address for this node. If no other addresses are available, marks the\n         * list to be refreshed on the next {@link #currentAddress()} call.\n         */\n        private void moveToNextAddress() {\n            if (addresses.isEmpty())\n                return; // Avoid div0. List will initialize on next currentAddress() call\n\n            addressIndex = (addressIndex + 1) % addresses.size();\n            if (addressIndex == 0)\n                clearAddresses(); // Exhausted list. Re-resolve on next currentAddress() call\n        }\n\n        private void resolveAddresses() throws UnknownHostException {\n            // (Re-)initialize list\n            addresses = ClientUtils.resolve(host, hostResolver);\n            if (log.isDebugEnabled()) {\n                log.debug(\"Resolved host {} to addresses {}\", host, addresses);\n            }\n            addressIndex = 0;\n\n            // We re-resolve DNS after disconnecting, but we don't want to immediately reconnect to the address we\n            // just disconnected from, in case we disconnected due to a problem with that IP (such as a load\n            // balancer instance failure). Check the first address in the list and skip it if it was the last address\n            // we tried and there are multiple addresses to choose from.\n            if (addresses.size() > 1 && addresses.get(addressIndex).equals(lastAttemptedAddress)) {\n                addressIndex++;\n            }\n        }\n\n        /**\n         * Clears the resolved addresses in order to trigger re-resolving on the next {@link #currentAddress()} call.\n         */\n        private void clearAddresses() {\n            addresses = Collections.emptyList();\n        }\n\n        public String toString() {\n            return \"NodeConnectionState(\" +\n                \"state=\" + state + \", \" +\n                \"lastConnectAttemptMs=\" + lastConnectAttemptMs + \", \" +\n                \"failedAttempts=\" + failedAttempts + \", \" +\n                \"failedConnectAttempts=\" + failedConnectAttempts + \", \" +\n                \"throttleUntilTimeMs=\" + throttleUntilTimeMs + \")\";\n        }\n    }\n}\n",
  "url": "https://github.com/apache/kafka/blob/trunk/clients/src/main/java/org/apache/kafka/clients/ClusterConnectionStates.java#L521-L568",
  "file_path": "clients/src/main/java/org/apache/kafka/clients/ClusterConnectionStates.java",
  "repo_name": "kafka",
  "language": "java",
  "start_line": 521,
  "end_line": 568,
  "last_modified": "2026-02-06T01:16:27.577459",
  "source_type": "github"
}