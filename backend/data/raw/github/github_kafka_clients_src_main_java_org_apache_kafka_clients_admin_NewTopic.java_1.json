{
  "id": "kafka_clients_src_main_java_org_apache_kafka_clients_admin_NewTopic.java_1",
  "title": "kafka/clients/src/main/java/org/apache/kafka/clients/admin/NewTopic.java",
  "content": "/*\n * Licensed to the Apache Software Foundation (ASF) under one or more\n * contributor license agreements. See the NOTICE file distributed with\n * this work for additional information regarding copyright ownership.\n * The ASF licenses this file to You under the Apache License, Version 2.0\n * (the \"License\"); you may not use this file except in compliance with\n * the License. You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\npackage org.apache.kafka.clients.admin;\n\nimport org.apache.kafka.common.message.CreateTopicsRequestData.CreatableReplicaAssignment;\nimport org.apache.kafka.common.message.CreateTopicsRequestData.CreatableTopic;\nimport org.apache.kafka.common.message.CreateTopicsRequestData.CreatableTopicConfig;\nimport org.apache.kafka.common.requests.CreateTopicsRequest;\n\nimport java.util.Collection;\nimport java.util.Collections;\nimport java.util.List;\nimport java.util.Map;\nimport java.util.Map.Entry;\nimport java.util.Objects;\nimport java.util.Optional;\n\n/**\n * A new topic to be created via {@link Admin#createTopics(Collection)}.\n */\npublic class NewTopic {\n\n    private final String name;\n    private final Optional<Integer> numPartitions;\n    private final Optional<Short> replicationFactor;\n    private final Map<Integer, List<Integer>> replicasAssignments;\n    private Map<String, String> configs = null;\n\n    /**\n     * A new topic with the specified replication factor and number of partitions.\n     */\n    public NewTopic(String name, int numPartitions, short replicationFactor) {\n        this(name, Optional.of(numPartitions), Optional.of(replicationFactor));\n    }\n\n    /**\n     * A new topic that optionally defaults {@code numPartitions} and {@code replicationFactor} to\n     * the broker configurations for {@code num.partitions} and {@code default.replication.factor}\n     * respectively.\n     */\n    public NewTopic(String name, Optional<Integer> numPartitions, Optional<Short> replicationFactor) {\n        this.name = name;\n        this.numPartitions = numPartitions;\n        this.replicationFactor = replicationFactor;\n        this.replicasAssignments = null;\n    }\n\n    /**\n     * A new topic with the specified replica assignment configuration.\n     *\n     * @param name the topic name.\n     * @param replicasAssignments a map from partition id to replica ids (i.e. broker ids). Although not enforced, it is\n     *                            generally a good idea for all partitions to have the same number of replicas.\n     *                            The first replica will be treated as the preferred leader.\n     */\n    public NewTopic(String name, Map<Integer, List<Integer>> replicasAssignments) {\n        this.name = name;\n        this.numPartitions = Optional.empty();\n        this.replicationFactor = Optional.empty();\n        this.replicasAssignments = Collections.unmodifiableMap(replicasAssignments);\n    }\n\n    /**\n     * The name of the topic to be created.\n     */\n    public String name() {\n        return name;\n    }\n\n    /**\n     * The number of partitions for the new topic or -1 if a replica assignment has been specified.\n     */\n    public int numPartitions() {\n        return numPartitions.orElse(CreateTopicsRequest.NO_NUM_PARTITIONS);\n    }\n\n    /**\n     * The replication factor for the new topic or -1 if a replica assignment has been specified.\n     */\n    public short replicationFactor() {\n        return replicationFactor.orElse(CreateTopicsRequest.NO_REPLICATION_FACTOR);\n    }\n\n    /**\n     * A map from partition id to replica ids (i.e. broker ids) or null if the number of partitions and replication\n     * factor have been specified instead.\n     */\n    public Map<Integer, List<Integer>> replicasAssignments() {\n        return replicasAssignments;\n    }\n\n    /**\n     * Set the configuration to use on the new topic.\n     *\n     * @param configs               The configuration map.\n     * @return                      This NewTopic object.\n     */\n    public NewTopic configs(Map<String, String> configs) {\n        this.configs = configs;\n        return this;\n    }\n\n    /**\n     * The configuration for the new topic or null if no configs ever specified.\n     */\n    public Map<String, String> configs() {\n        return configs;\n    }\n\n    CreatableTopic convertToCreatableTopic() {\n        CreatableTopic creatableTopic = new CreatableTopic().\n            setName(name).\n            setNumPartitions(numPartitions.orElse(CreateTopicsRequest.NO_NUM_PARTITIONS)).\n            setReplicationFactor(replicationFactor.orElse(CreateTopicsRequest.NO_REPLICATION_FACTOR));\n        if (replicasAssignments != null) {\n            for (Entry<Integer, List<Integer>> entry : replicasAssignments.entrySet()) {\n                creatableTopic.assignments().add(\n                    new CreatableReplicaAssignment().\n                        setPartitionIndex(entry.getKey()).\n                        setBrokerIds(entry.getValue()));\n            }\n        }\n        if (configs != null) {\n            for (Entry<String, String> entry : configs.entrySet()) {\n                creatableTopic.configs().add(\n                    new CreatableTopicConfig().\n                        setName(entry.getKey()).\n                        setValue(entry.getValue()));\n            }\n        }\n        return creatableTopic;\n    }\n\n    @Override\n    public String toString() {",
  "url": "https://github.com/apache/kafka/blob/trunk/clients/src/main/java/org/apache/kafka/clients/admin/NewTopic.java#L1-L150",
  "file_path": "clients/src/main/java/org/apache/kafka/clients/admin/NewTopic.java",
  "repo_name": "kafka",
  "language": "java",
  "start_line": 1,
  "end_line": 150,
  "last_modified": "2026-02-06T01:16:27.586859",
  "source_type": "github"
}