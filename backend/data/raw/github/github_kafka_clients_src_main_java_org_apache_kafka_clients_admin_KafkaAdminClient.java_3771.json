{
  "id": "kafka_clients_src_main_java_org_apache_kafka_clients_admin_KafkaAdminClient.java_3771",
  "title": "kafka/clients/src/main/java/org/apache/kafka/clients/admin/KafkaAdminClient.java",
  "content": "    }\n\n    @Override\n    public DeleteConsumerGroupOffsetsResult deleteConsumerGroupOffsets(\n        String groupId,\n        Set<TopicPartition> partitions,\n        DeleteConsumerGroupOffsetsOptions options) {\n        SimpleAdminApiFuture<CoordinatorKey, Map<TopicPartition, Errors>> future =\n            DeleteConsumerGroupOffsetsHandler.newFuture(groupId);\n        DeleteConsumerGroupOffsetsHandler handler = new DeleteConsumerGroupOffsetsHandler(groupId, partitions, logContext);\n        invokeDriver(handler, future, options.timeoutMs);\n        return new DeleteConsumerGroupOffsetsResult(future.get(CoordinatorKey.byGroupId(groupId)), partitions);\n    }\n\n    @Override\n    public DeleteStreamsGroupOffsetsResult deleteStreamsGroupOffsets(\n        String groupId,\n        Set<TopicPartition> partitions,\n        DeleteStreamsGroupOffsetsOptions options) {\n        DeleteConsumerGroupOffsetsOptions consumerGroupOptions = new DeleteConsumerGroupOffsetsOptions()\n            .timeoutMs(options.timeoutMs());\n        return new DeleteStreamsGroupOffsetsResult(deleteConsumerGroupOffsets(groupId, partitions, consumerGroupOptions));\n    }\n\n    @Override\n    public DescribeShareGroupsResult describeShareGroups(final Collection<String> groupIds,\n                                                         final DescribeShareGroupsOptions options) {\n        SimpleAdminApiFuture<CoordinatorKey, ShareGroupDescription> future =\n            DescribeShareGroupsHandler.newFuture(groupIds);\n        DescribeShareGroupsHandler handler = new DescribeShareGroupsHandler(options.includeAuthorizedOperations(), logContext);\n        invokeDriver(handler, future, options.timeoutMs);\n        return new DescribeShareGroupsResult(future.all().entrySet().stream()\n            .collect(Collectors.toMap(entry -> entry.getKey().idValue, Map.Entry::getValue)));\n    }\n\n    @Override\n    public AlterShareGroupOffsetsResult alterShareGroupOffsets(final String groupId,\n                                                               final Map<TopicPartition, Long> offsets,\n                                                               final AlterShareGroupOffsetsOptions options) {\n        SimpleAdminApiFuture<CoordinatorKey, Map<TopicPartition, ApiException>> future = AlterShareGroupOffsetsHandler.newFuture(groupId);\n        AlterShareGroupOffsetsHandler handler = new AlterShareGroupOffsetsHandler(groupId, offsets, logContext);\n        invokeDriver(handler, future, options.timeoutMs);\n        return new AlterShareGroupOffsetsResult(future.get(CoordinatorKey.byGroupId(groupId)));\n    }\n\n    @Override\n    public ListShareGroupOffsetsResult listShareGroupOffsets(final Map<String, ListShareGroupOffsetsSpec> groupSpecs,\n                                                             final ListShareGroupOffsetsOptions options) {\n        SimpleAdminApiFuture<CoordinatorKey, Map<TopicPartition, SharePartitionOffsetInfo>> future = ListShareGroupOffsetsHandler.newFuture(groupSpecs.keySet());\n        ListShareGroupOffsetsHandler handler = new ListShareGroupOffsetsHandler(groupSpecs, logContext);\n        invokeDriver(handler, future, options.timeoutMs);\n        return new ListShareGroupOffsetsResult(future.all());\n    }\n\n    @Override\n    public DeleteShareGroupOffsetsResult deleteShareGroupOffsets(final String groupId,\n                                                                 final Set<String> topics,\n                                                                 final DeleteShareGroupOffsetsOptions options) {\n        SimpleAdminApiFuture<CoordinatorKey, Map<String, ApiException>> future = DeleteShareGroupOffsetsHandler.newFuture(groupId);\n        DeleteShareGroupOffsetsHandler handler = new DeleteShareGroupOffsetsHandler(groupId, topics, logContext);\n        invokeDriver(handler, future, options.timeoutMs);\n        return new DeleteShareGroupOffsetsResult(future.get(CoordinatorKey.byGroupId(groupId)), topics);\n    }\n\n    @Override\n    public DescribeStreamsGroupsResult describeStreamsGroups(final Collection<String> groupIds,\n                                                             final DescribeStreamsGroupsOptions options) {\n        SimpleAdminApiFuture<CoordinatorKey, StreamsGroupDescription> future =\n            DescribeStreamsGroupsHandler.newFuture(groupIds);\n        DescribeStreamsGroupsHandler handler = new DescribeStreamsGroupsHandler(options.includeAuthorizedOperations(), logContext);\n        invokeDriver(handler, future, options.timeoutMs);\n        return new DescribeStreamsGroupsResult(future.all().entrySet().stream()\n            .collect(Collectors.toMap(entry -> entry.getKey().idValue, Map.Entry::getValue)));\n    }\n\n    @Override\n    public DescribeClassicGroupsResult describeClassicGroups(final Collection<String> groupIds,\n                                                             final DescribeClassicGroupsOptions options) {\n        SimpleAdminApiFuture<CoordinatorKey, ClassicGroupDescription> future =\n            DescribeClassicGroupsHandler.newFuture(groupIds);\n        DescribeClassicGroupsHandler handler = new DescribeClassicGroupsHandler(options.includeAuthorizedOperations(), logContext);\n        invokeDriver(handler, future, options.timeoutMs);\n        return new DescribeClassicGroupsResult(future.all().entrySet().stream()\n            .collect(Collectors.toMap(entry -> entry.getKey().idValue, Map.Entry::getValue)));\n    }\n\n    @Override\n    public DeleteShareGroupsResult deleteShareGroups(Collection<String> groupIds, DeleteShareGroupsOptions options) {\n        SimpleAdminApiFuture<CoordinatorKey, Void> future =\n            DeleteShareGroupsHandler.newFuture(groupIds);\n        DeleteShareGroupsHandler handler = new DeleteShareGroupsHandler(logContext);\n        invokeDriver(handler, future, options.timeoutMs);\n        return new DeleteShareGroupsResult(future.all().entrySet().stream()\n            .collect(Collectors.toMap(entry -> entry.getKey().idValue, Map.Entry::getValue)));\n    }\n\n    @Override\n    public Map<MetricName, ? extends Metric> metrics() {\n        return Collections.unmodifiableMap(this.metrics.metrics());\n    }\n\n    @Override\n    public ElectLeadersResult electLeaders(\n        final ElectionType electionType,\n        final Set<TopicPartition> topicPartitions,\n        ElectLeadersOptions options) {\n        final KafkaFutureImpl<Map<TopicPartition, Optional<Throwable>>> electionFuture = new KafkaFutureImpl<>();\n        final long now = time.milliseconds();\n        runnable.call(new Call(\"electLeaders\", calcDeadlineMs(now, options.timeoutMs()),\n            new ControllerNodeProvider()) {\n\n            @Override\n            public ElectLeadersRequest.Builder createRequest(int timeoutMs) {\n                return new ElectLeadersRequest.Builder(electionType, topicPartitions, timeoutMs);\n            }\n\n            @Override\n            public void handleResponse(AbstractResponse abstractResponse) {\n                ElectLeadersResponse response = (ElectLeadersResponse) abstractResponse;\n                Map<TopicPartition, Optional<Throwable>> result = ElectLeadersResponse.electLeadersResult(response.data());\n\n                // For version == 0 then errorCode would be 0 which maps to Errors.NONE\n                Errors error = Errors.forCode(response.data().errorCode());\n                if (error != Errors.NONE) {\n                    electionFuture.completeExceptionally(error.exception());\n                    return;\n                }\n\n                electionFuture.complete(result);\n            }\n\n            @Override\n            void handleFailure(Throwable throwable) {\n                electionFuture.completeExceptionally(throwable);\n            }\n        }, now);\n\n        return new ElectLeadersResult(electionFuture);\n    }\n\n    @Override\n    public AlterPartitionReassignmentsResult alterPartitionReassignments(\n        Map<TopicPartition, Optional<NewPartitionReassignment>> reassignments,\n        AlterPartitionReassignmentsOptions options) {\n        final Map<TopicPartition, KafkaFutureImpl<Void>> futures = new HashMap<>();\n        final Map<String, Map<Integer, Optional<NewPartitionReassignment>>> topicsToReassignments = new TreeMap<>();\n        for (Map.Entry<TopicPartition, Optional<NewPartitionReassignment>> entry : reassignments.entrySet()) {\n            String topic = entry.getKey().topic();\n            int partition = entry.getKey().partition();\n            TopicPartition topicPartition = new TopicPartition(topic, partition);",
  "url": "https://github.com/apache/kafka/blob/trunk/clients/src/main/java/org/apache/kafka/clients/admin/KafkaAdminClient.java#L3771-L3920",
  "file_path": "clients/src/main/java/org/apache/kafka/clients/admin/KafkaAdminClient.java",
  "repo_name": "kafka",
  "language": "java",
  "start_line": 3771,
  "end_line": 3920,
  "last_modified": "2026-02-06T01:16:27.585045",
  "source_type": "github"
}