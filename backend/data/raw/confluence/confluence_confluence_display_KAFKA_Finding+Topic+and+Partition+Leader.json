{
  "id": "confluence_display_KAFKA_Finding+Topic+and+Partition+Leader",
  "title": "Finding Topic and Partition Leader - Apache Kafka - Apache Software Foundation",
  "content": "Finding the Topic and Partition Leader data for a cluster\nFinding all the Topics, Partitions, Partition Leaders and Replicas for a cluster requires using a TopicMetaDataRequest in the SimpleConsumer.\nThe following code will connect to a Broker and print out all the Topics, Partitions, which Broker is a the leader and which Brokers are replicas for the Partitions.\nBy passing an empty List<String> to the TopicMetadatRequest you are asking Kafka to return data on all Topics.\nimport kafka.javaapi.TopicMetadataRequest;\nimport kafka.javaapi.consumer.SimpleConsumer;\nimport java.util.ArrayList;\nimport java.util.List;\npublic class MetaDataDump {\npublic static void main(String[] args) {\nkafka.javaapi.consumer.SimpleConsumer consumer  = new SimpleConsumer(\"broker1.test\",\n9092,\n100000,\n64 * 1024, \"test\");\nList<String> topics2 = new ArrayList<String>();\nTopicMetadataRequest req = new TopicMetadataRequest(topics2);\nkafka.javaapi.TopicMetadataResponse resp = consumer.send(req);\nList<kafka.javaapi.TopicMetadata> data3 =  resp.topicsMetadata();\nfor (kafka.javaapi.TopicMetadata item : data3) {\nSystem.out.println(\"Topic: \" + item.topic());\nfor (kafka.javaapi.PartitionMetadata part: item.partitionsMetadata() ) {\nString replicas = \"\";\nString isr = \"\";\nfor (kafka.cluster.Broker replica: part.replicas() ) {\nreplicas += \" \" + replica.host();\n}\nfor (kafka.cluster.Broker replica: part.isr() ) {\nisr += \" \" + replica.host();\n}\nSystem.out.println( \"    Partition: \" +   part.partitionId()  + \": Leader: \" + part.leader().host() + \" Replicas:[\" + replicas + \"] ISR:[\" + isr + \"]\");\n}\n}\n}\n}\nTo find the details for a specific Topic, add the name to the List<String> passed to the TopicMetadataRequest:\nList<String> topics2 = new ArrayList<String>();\ntopics2.add(\"my-topic\");\nTopicMetadataRequest req = new TopicMetadataRequest(topics2);\nkafka.javaapi.TopicMetadataResponse resp = consumer.send(req);",
  "url": "https://cwiki.apache.org/confluence/display/KAFKA/Finding+Topic+and+Partition+Leader",
  "space": "KAFKA",
  "labels": [],
  "last_modified": null,
  "source_type": "confluence"
}