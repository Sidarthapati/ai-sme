{
  "id": "confluence_display_KAFKA_Kafka+0.9+Unit+and+Integration+Tests",
  "title": "Kafka 0.9 Unit and Integration Tests - Apache Kafka - Apache Software Foundation",
  "content": "Pre-0.8 the integration tests span over core/src/test, some of them resides in the unit.kafka, some others in other.kafka. In 0.9 we want to have a cleaner coverage of integration tests along with the unit tests.\nUnit Test\nFor each low-level component of kafka server and client that is self-functional, such as bufferpool/sende of producer, memoryrecords of common, replica/partition-manager of server, we will have a corresponding unit test class in the test/unit/<package-name>/<component-name>.\nkafka.common:\nconfig: config properties can be read/write correctly, default value can be retrieved, config errors can be detected.\nprotocol: schema fields can be put/get by pos/name correctly, schema/arrays can be serialized/de-ser correctly.\nrecord:\nrecord fields can be read/write correctly, record functions (size, isValid, checksum) works correctly.\nmemory-records functions (append with/wo compression, etc) works correctly.\nrequests: request serialization/de-ser correctly, and non-null fields are defined.\nmetadata:\ncluster/topic-partition/partition functions works correctly.\nserializer works properly.\nnetwork:\nnetworksend/receive functions work correctly.\nbyterbuffersend/receive functions work correctly.\nselector functions work correctly (may need some MockChannels).\nkafka.clients.producer\npartitioner: logical correctness.\nrecordsend: functions work correctly (may need MockCallback).\nbufferpool: logical correct under multi-thread, failure cases.\nmetadata: logical correct under multi-thread, failure cases.\nrecordaccumulator: functional correct for read/drain, etc; logical correct for append under multi-thread.\nrecordbatch: succeed/fail cases of functions (tryAppend, etc)\nsender:\nprocessReadyPartitions\nfunction, handleXX functions, and close function correctness.\nkafka.server\nlog: log recover and cleaning logical correctness\nMORE...\nIntegration Test\nFor integration tests we will categories the following modules, and for each module we will do integration tests for different scenarios (normal success cases, failure cases with different configs, etc).\n\" * \" indicate tests that we can start in parallel with producer code stabilization.\nadmin\nCreate topic\nAdding partitions to topic\nAlter topic configs (retention, etc)\nAlter topic replication factor\nPartition reassignment\nPreferred leader election\napi\nProducer: *\nBlocking and non-blocking send behavior, with different message size (including too-large message size)\nSend behavior with null key or null value\nSend with specific partition key(s)\nNew topic auto-creation\nConsumer:\nCommit and fetch offset behavior\nPoll behavior with/wo timeout, different fetch size\nRebalance behavior\nTopic change capture behavior\nconfig\nInvalid values *\nreplication (with broker hard/soft failures and restart, network partition scenarios)\nReplica consistency and ISR correctness\nController failover behavior\nCoordinator failover behavior\nNo message-loss with ack > 1 *\ncompression *\ncompress/decompress behavior with different batch size\ndecompress/re-compress in mirror-maker (?)\nlogging\nString encoder\nAppender property\nutil (?)",
  "url": "https://cwiki.apache.org/confluence/display/KAFKA/Kafka+0.9+Unit+and+Integration+Tests",
  "space": "KAFKA",
  "labels": [],
  "last_modified": null,
  "source_type": "confluence"
}