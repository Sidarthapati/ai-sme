{
  "id": "confluence_display_KAFKA_Kafka+data+structures+in+Zookeeper",
  "title": "Kafka data structures in Zookeeper - Apache Kafka - Apache Software Foundation",
  "content": "0.8:\n1. Topic registration info:\n/brokers/topics/[topic] :\nSchema:\n{ \"fields\" :\n[ {\"name\": \"version\", \"type\": \"int\", \"doc\": \"version id\"},\n{\"name\": \"partitions\",\n\"type\": {\"type\": \"map\",\n\"values\": {\"type\": \"array\", \"items\": \"int\", \"doc\": \"a list of replica ids\"},\n\"doc\": \"a map from partition id to replica list\"},\n}\n]\n}\nExample:\n{\n\"version\": 1,\n\"partitions\": {\"0\": [0, 1, 3] } }\n}\n2. Partition state info:\n/brokers/topics/[topic]/partitions/[partitionId]/state\nSchema:\n{ \"fields\":\n[ {\"name\": \"version\", \"type\": \"int\", \"doc\": \"version id\"},\n{\"name\": \"isr\",\n\"type\": {\"type\": \"array\",\n\"items\": \"int\",\n\"doc\": \"an array of the id of replicas in isr\"}\n},\n{\"name\": \"leader\", \"type\": \"int\", \"doc\": \"id of the leader replica\"},\n{\"name\": \"controller_epoch\", \"type\": \"int\", \"doc\": \"epoch of the controller that last updated the leader and isr info\"},\n{\"name\": \"leader_epoch\", \"type\": \"int\", \"doc\": \"epoch of the leader\"}\n]\n}\nExample:\n{\n\"version\": 1,\n\"isr\": [0,1],\n\"leader\": 0,\n\"controller_epoch\": 1,\n\"leader_epoch\": 0\n}\n3. Broker registration info:\n/brokers/ids/[brokerId]\nSchema:\n{ \"fields\":\n[ {\"name\": \"version\", \"type\": \"int\", \"doc\": \"version id\"},\n{\"name\": \"host\", \"type\": \"string\", \"doc\": \"ip address or host name of the broker\"},\n{\"name\": \"port\", \"type\": \"int\", \"doc\": \"port of the broker\"},\n{\"name\": \"jmx_port\", \"type\": \"int\", \"doc\": \"port for jmx\"}\n]\n}\nExample:\n{\n\"version\": 1,\n\"host\": \"192.168.1.148\",\n\"port\": 9092,\n\"jmx_port\": 9999\n}\n4. Controller epoch:\n/controller_epoch -> int (epoch)\n5. Controller registration:\n/controller -> int (broker id of the controller)\n6. Consumer registration:\n/consumers/[groupId]/ids/[consumerId]\nSchema:\n{ \"fields\":\n[ {\"name\": \"version\", \"type\": \"int\", \"doc\": \"version id\"},\n{\"name\": \"pattern\", \"type\": \"string\", \"doc\": \"can be of static, white_list or black_list\"},\n{\"name\": \"subscription\", \"type\" : {\"type\": \"map\", \"values\": {\"type\": \"int\"},\n\"doc\": \"a map from a topic or a wildcard pattern to the number of streams\"}      }    ]\n}\nExample:\nA static subscription:\n{\n\"version\": 1,\n\"pattern\": \"static\",\n\"subscription\": {\"topic1\": 1, \"topic2\": 2}\n}\nA whitelist subscription:\n{\n\"version\": 1,\n\"pattern\": \"white_list\",\n\"subscription\": {\"abc\": 1}}\nA blacklist subscription:\n{\n\"version\": 1,\n\"pattern\": \"black_list\",\n\"subscription\": {\"abc\": 1}}\n7. Consumer owner:\n/consumers/[groupId]/owners/[topic]/[partitionId] -> string (consumerId)\n8. Consumer offset:\n/consumers/[groupId]/offsets/[topic]/[partitionId] -> long (offset)\n9. Re-assign partitions\n/admin/reassign_partitions\n{\n\"fields\":[\n{\n\"name\":\"version\",\n\"type\":\"int\",\n\"doc\":\"version id\"\n},\n{\n\"name\":\"partitions\",\n\"type\":{\n\"type\":\"array\",\n\"items\":{\n\"fields\":[\n{\n\"name\":\"topic\",\n\"type\":\"string\",\n\"doc\":\"topic of the partition to be reassigned\"\n},\n{\n\"name\":\"partition\",\n\"type\":\"int\",\n\"doc\":\"the partition to be reassigned\"\n},\n{\n\"name\":\"replicas\",\n\"type\":\"array\",\n\"items\":\"int\",\n\"doc\":\"a list of replica ids\"\n}\n],\n}\n\"doc\":\"an array of partitions to be reassigned to new replicas\"\n}\n}\n]\n}\nExample:\n{\n\"version\": 1,\n\"partitions\":\n[\n{\n\"topic\": \"Foo\",\n\"partition\": 1,\n\"replicas\": [0, 1, 3]\n}\n]\n}\n10. Preferred replication election\n/admin/preferred_replica_election\n{\n\"fields\":[\n{\n\"name\":\"version\",\n\"type\":\"int\",\n\"doc\":\"version id\"\n},\n{\n\"name\":\"partitions\",\n\"type\":{\n\"type\":\"array\",\n\"items\":{\n\"fields\":[\n{\n\"name\":\"topic\",\n\"type\":\"string\",\n\"doc\":\"topic of the partition for which preferred replica election should be triggered\"\n},\n{\n\"name\":\"partition\",\n\"type\":\"int\",\n\"doc\":\"the partition for which preferred replica election should be triggered\"\n}\n],\n}\n\"doc\":\"an array of partitions for which preferred replica election should be triggered\"\n}\n}\n]\n}\nExample:\n{\n\"version\": 1,\n\"partitions\":\n[\n{\n\"topic\": \"Foo\",\n\"partition\": 1\n},\n{\n\"topic\": \"Bar\",\n\"partition\": 0\n}\n]\n}\n11. Delete topics\n/admin/delete_topics/[topic_to_be_deleted] (the value of the path in empty)\n0.8.1\nTopic Configuration\n/config/topics/[topic_name]\nExample\n{\n\"version\": 1,\n\"config\": {\n\"config.a\": \"x\",\n\"config.b\": \"y\",\n...\n}\n}\n/config/changes/[config_change_x] -> \"topic_name\"\nContains the name of the topic that changed.\n0.9.0\nClient and Topic configuration overrides: The content of both znodes has the same structure\n/config/clients/[topic_name]\n/config/topics/[topic_name]\n{\n\"version\": 1,\n\"config\": {\n\"config.a\": \"x\",\n\"config.b\": \"y\",\n...\n}\n}\nConfig Change notification (Topic and Client config)\n{\"version\" : 1, \"entity_type\":\"topics/clients\", \"entity_name\" : \"topic_name/client_id\"}\nISR Change notification\n/isr_change_notification/isr_change_x\nGets created when ISR is changed at any broker, controller watches for these notifications and sends MetadataUpdateRequest to all brokers.\nBroker registration info\n/brokers/ids/[brokerId]\nSchema:\n{ \"fields\":\n[ {\"name\": \"version\", \"type\": \"int\", \"doc\": \"version id\"},\n{\"name\": \"host\", \"type\": \"string\", \"doc\": \"ip address or host name of the broker\"},\n{\"name\": \"port\", \"type\": \"int\", \"doc\": \"port of the broker\"},\n{\"name\": \"jmx_port\", \"type\": \"int\", \"doc\": \"port for jmx\"}\n{\"name\": \"endpoints\", \"type\": \"array\", \"items\": \"string\", \"doc\": \"endpoints supported by the broker\"}\n]\n}\nExample:\n{\n\"version\":2,\n\"host\",\"localhost\",\n\"port\",9092\n\"jmx_port\":9999,\n\"timestamp\":\"2233345666\",\n\"endpoints\": [\"PLAINTEXT://host1:9092\", \"SSL://host1:9093\"]\n}\nACL info. The content of these znodes have the same structure\n/kafka-acl/Topic/[topic_name]\n/kafka-acl/Cluster/kafka-cluster\n/kafka-acl/Group/[groupId]\n{\"version\": 1, \"acls\": [ { \"host\":\"host1\", \"permissionType\": \"Allow\",\"operation\": \"Read\",\"principal\": \"User:alice\"}]}\n0.10\nBroker registration info\n/brokers/ids/[brokerId]\nSchema:\n{ \"fields\":\n[ {\"name\": \"version\", \"type\": \"int\", \"doc\": \"version id\"},\n{\"name\": \"host\", \"type\": \"string\", \"doc\": \"ip address or host name of the broker\"},\n{\"name\": \"port\", \"type\": \"int\", \"doc\": \"port of the broker\"},\n{\"name\": \"jmx_port\", \"type\": \"int\", \"doc\": \"port for jmx\"}\n{\"name\": \"endpoints\", \"type\": \"array\", \"items\": \"string\", \"doc\": \"endpoints supported by the broker\"}\n{\"name\": \"rack\", \"type\": \"string\", \"doc\": \"Rack of the broker. Optional. This will be used in rack aware replication assignment for fault tolerance.\"}\n]\n}\nExample:\n{\n\"version\":3,\n\"host\":\"localhost\",\n\"port\":9092,\n\"jmx_port\":9999,\n\"timestamp\":\"2233345666\",\n\"endpoints\": [\"PLAINTEXT://host1:9092\", \"SSL://host1:9093\"],\n\"rack\": \"us-east-1c\"\n}",
  "url": "https://cwiki.apache.org/confluence/display/KAFKA/Kafka+data+structures+in+Zookeeper",
  "space": "KAFKA",
  "labels": [],
  "last_modified": null,
  "source_type": "confluence"
}